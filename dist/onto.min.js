/*! onto.js 2015-05-23 */

!function(a,b){"use strict";"function"==typeof define&&define.amd?define(["../dist/Class.min","../dist/Namespace.min","../dist/EventEmitter.min","../dist/ReferenceObject.min","../dist/Collection.min","underscore"],b):"object"==typeof exports?module.exports=b(require("../dist/Class.min"),require("../dist/Namespace.min"),require("../dist/EventEmitter.min"),require("../dist/ReferenceObject.min"),require("../dist/Collection.min"),require("../dist/underscore")):a.Onto=b(a.Class,a.Namespace,a.EventEmitter,a.ReferenceObject,a.Collection,a._)}(this,function(Class,Namespace,EventEmitter,ReferenceObject,Collection,underscore){"use strict";if("undefined"==typeof _)var _=underscore;var Onto=new Namespace("Onto",null,{Class:Class,EventEmitter:EventEmitter,Namespace:Namespace,ReferenceObject:ReferenceObject,Collection:Collection,_:underscore||_});!function(){var a=function(a,b,c){return a=a||0,b=b||1,c=c!==!1,function(){return c?Math.floor(Math.random()*(b-a+1))+a:Math.random()*(b-a)+a}},b={random:a},c=b.defaults={numberOfDie:1,typeOfDie:6,modifier:0},d=b.roll=function(b,d,e){b=b||c.numberOfDie,d=d||c.typeOfDie,e=e||c.modifier;for(var f={multiple:b,typeOfDie:d,modifier:e,rolls:[],value:0},g=1;b+1>g;++g){var h=a(1,d)();f.rolls.push(h),f.value+=h}return f.value+=e,f.toString=function(a){return f.value.toString(a||10)},f.valueOf=function(){return f.value},f};b.d=function(a){return d(1,a)};b.createRoll=function(a,d,e){return a=a||c.numberOfDie,d=d||c.typeOfDie,e=e||c.modifier,function(){return b.roll(a,d,e)}},b.parseString=function(a){if(a&&a.indexOf("d")>-1){var c=a.split("d"),d=c[0];c=c[1];var e=0;if(c.indexOf("m")>-1&&(e=c.split("m"),c=e[0],e=e.length>1?e[1]:0),d=parseInt(d.toString()),c=parseInt(c.toString()),e=parseInt(e.toString()),isNaN(d))throw new Error("The number of dice is not a number!");if(isNaN(c))throw new Error("The type of dice is not a number!");if(isNaN(e))throw new Error("The modifier is not a number!");return b.roll(d,c,e)}throw new Error("parseString() usage: pass the number of dice, type of dice, and modifier like so: 2d6m-8\nexample: parseString('2d6m-8') or parseString('3d6')")},b.test=function(a,c){c=c||100;for(var d={},e=0;e<a.length;++e){if(3!==a[e].length)throw new Error("test() usage: pass an array with subarrays, each containing the number of dice, type of dice, and modifier like so: [[3, 6, 0], [1, 10, 2]]");console.time("Dice");var f=a[e][0],g=a[e][1],h=a[e][2];console.log("Iterating "+c+" times over "+f+"d"+g+"+"+h);for(var i=0;c>i;++i){var j=b.roll(f,g,h);d[j.value.toString()]||(d[j.value.toString()]=0),++d[j.value.toString()]}console.log(JSON.stringify(d)),d={},console.timeEnd("Dice")}},new Namespace("Dice",Onto,b)}(),function(){var Base=new Class({isAbstract:!0,UniqueID:"",init:function(a){var b=this,c=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0,c="x"==a?b:3&b|8;return c.toString(16)})};b.UniqueID=a.UniqueID||c()},parse:function(data){return Onto._.isObject(data)&&Onto._.forEach(data,function(value,key,list){data[key]=value.hasOwnProperty("FullyQualifiedName")?eval("new "+value.FullyQualifiedName+"("+JSON.stringify(value)+")"):value}),data},toJSON:Class(function(){var a={FullyQualifiedName:this.Type.getFullyQualifiedName?this.Type.getFullyQualifiedName():""};return a=Onto._.extend(a,this)})});Onto.addClass("Base",Base)}(),function(){var a=new Class({isAbstract:!0,inherits:Onto.Base,init:function b(a){var c=this;a=a||{},b["super"].call(c,a),Class.define(c,"Size",{get:function(){throw new Error("Size must be overridden")},enumerable:!0,configurable:!0}),Class.define(c,"HitPoints",{get:function(){throw new Error("HitPoints must be overridden")},enumerable:!0,configurable:!0}),Class.define(c,"CurrentDamage",{get:function(){var a=0;for(var b in c.HitLocations)for(var d=0;d<c.HitLocations[b].Wounds.length;++d)a+=c.HitLocations[b].Wounds[d].Value;return a},enumerable:!0}),Class.define(c,"Damage",{value:function(a,b){var d=null,e=a.Value;for(var f in c.Inventory[b])c.Inventory[b][f]&&c.Inventory[b][f].Armor&&(d=c.Inventory[b][f].Armor,Wound.Value-=(d[a.DamageType]||0)*(d.Value||0));a.Value<1?a=null:e/2>a.Value&&(a.DamageType="Blunt",a.Shard=null),a&&c.HitLocations[b].Wounds.push(a)},enumerable:!0}),Class.define(c,"LoadBodyDefinition",Class(function(a){var b=0,d=0;for(var e in a.Locations)!function(e){var f=a.Locations[e];for(c.HitLocations[e]=f,c.Inventory[e]=f.InventorySlots;b<d+f.Percentage;++b)c.LocationLookup[b.toString()]=e;d=b}(e)})),Class.define(c,"HitLocations",Class(a.HitLocations||{}).Enumerable()),Class.define(c,"LocationLookup",Class({})),Class.define(c,"LookupLocation",Class(function(a){var b=c.LocationLookup[a.toString()];return c.HitLocations[b]}))}});Onto.addClass("Body",a)}(),function(){var a=new Class({inherits:Onto.Body,isAbstract:!0,init:function b(a){var c=this;a=a||{},b["super"].call(c,a),Class.define(c,"Size",Class(a.Size).Enumerable().Writable()),Class.define(c,"HitPoints",Class(a.HitPoints).Enumerable().Writable())}});Onto.addClass("Item",a)}(),function(){var a=new Class({inherits:Onto.Item,isAbstract:!0,init:function b(a){var c=this;a=a||{},b["super"].call(c,a),a=c.parse(a)},Capacity:{get:function(){for(var a=this,b={Current:0,Maximum:a.Size},c=0;c<a.Container.length;++c)b.Current+=a.Container[c].Size;return b}},insertItem:{value:function(a){var b=this,c=b.Capacity;a.UniqueID&&c.Current+a.Size<=b.Size&&(this.Container.push(a),this.Index[a.UniqueID]=a)}},removeItem:{value:function(a){var b=[];return this.find(a,function(a,c,d){b.push(d.Container.splice(c,1)[0])}),b}},find:{value:function(a,b){var c=[],d=this;if(b=b||null,d.Index[a])c.push(d.Index[a]);else for(var e=0;e<this.Container.length;++e){var f=this.Container[e];(f.hasOwnProperty("FullyQualifiedName")&&f.FullyQualifiedName==a||f instanceof a||f===a)&&(b?b(f,index,d):c.push({Item:f,Index:e})),++index}return c}},ParentContainer:Class(null).Writable(),Container:Class(new Collection),Index:Class({})});Onto.addClass("ContainerItem",a)}(),function(){var a=new Class({inherits:Onto.ContainerItem,init:function b(a){var c=this;a=a||{},b["super"].call(c,a),a=c.parse(a)}});Onto.addClass("Inventory",a)}(),function(){var a=new Class({inherits:Onto.Item,init:function(a){a=a||{}},Value:Class(0).Enumerable().Writable(),Blunt:Class(0).Enumerable().Writable(),Cut:Class(0).Enumerable().Writable(),Burn:Class(0).Enumerable().Writable(),Pierce:Class(0).Enumerable().Writable(),Freeze:Class(0).Enumerable().Writable(),Poison:Class(0).Enumerable().Writable()});Onto.addClass("Armor",a)}(),Onto.addNamespace(new Namespace("Damage")),function(){var a=new Class({inherits:Onto.Base,isAbstract:!0,init:function(a,b,c){var d=this;d.Value=a||0,d.Shard=b||null,d.Timestamp=c||(new Date).getTime()},Value:Class(0).Enumerable().Writable(),Shard:Class(null).Enumerable().Writable(),Timestamp:Class(0).Enumerable().Writable(),DamageType:Class("").Enumerable().Writable()});a.Types=["Blunt","Cut","Burn","Pierce","Freeze","Poison"],Onto.Damage.addClass("Damage",a);for(var b=0;b<a.Types.length;++b){var c=a.Types[b];!function(b){var c=new Class({inherits:a,init:function d(a,c,e){d["super"].call(this,a,c,e),this.DamageType=b}});Onto.Damage.addClass(b,c)}(c)}}(),Onto.addNamespace(new Namespace("Weapon")),function(){var a=function(){return new Onto.Damage.Blunt(Onto.Dice.roll(1,3).value)},b=new Class({isAbstract:!0,inherits:Onto.Item,init:function(){var b=this;b.Attack.Bash=a},Attack:Class({}).Enumerable(),CriticalMultiplier:Class(1.5).Enumerable().Writable(),Material:Class(null).Enumerable(),Weight:Class(0).Enumerable()});Onto.Weapon.addClass("Weapon",b);var c=new Class({isAbstract:!0,inherits:Onto.Weapon,init:function e(a){var b=this;e["super"].call(b,a),b.MaxRange=10*b.RangeIncrement,b.Attack.Shoot=function(a){if(a&&a.Count){--a.Count;var b=dice.roll(1,8,0).value;return a.Damage(b)}throw new Error("That ammunition type is incorrect!")}},RangeIncrement:20,MaxRange:100});Onto.Weapon.addClass("RangedWeapon",c);var d=new Class({isAbstract:!0,inherits:Onto.Weapon.RangedWeapon,init:function f(a){var b=this;f["super"].call(b,a),b.MaxRange=5*this.RangeIncrement,b.Attack.Throw=function(){var a=dice.roll(1,4,0).value;return new Damage.Blunt.Class(a)}}});Onto.Weapon.addClass("ThrownWeapon",d)}(),Onto.addNamespace(new Namespace("Skill")),function(){var a=new Class({inherits:Onto.Base,init:function(a,b,c,d){var e=this,f=b;d=d||0;var g=a.split(".").reverse();Class.define(e,"namePath",Class(a).Enumerable()),Class.define(e,"value",{get:function(){return f},enumerable:!0}),Class.define(e,"valueOf",Class(function(){return f})),Class.define(e,"useCount",Class(d).Enumerable().Writable()),Class.define(e,"description",Class(c||"The general skill of "+g.join(" ").toLowerCase()).Enumerable()),Class.define(e,"increment",Class(function(){++f}))}});Onto.Skill.addClass("Specialization",a)}(),function(){var a={loadDefaults:function(){var a={},b=Onto.Skill.Specialization;return a.Firearms=new b("Firearms",-10,"The general skill of using all firearm weapons"),a["Firearms.Pistol"]=new b("Firearms.Pistol",-10,"The general skill of using all pistols"),a["Firearms.Pistol.Pipe"]=new b("Firearms.Pistol.Pipe",-5,"The general skill of using all makeshift pistols"),a["Firearms.SMG"]=new b("Firearms.SMG",-15,"The general skill of using all submachine guns"),a["Firearms.Rifle"]=new b("Firearms.Rifle",-5,"The general skill of using all rifles"),a["Firearms.MG"]=new b("Firearms.MG",-15,"The general skill of using all large mounted machine guns"),a.Archery=new b("Archery",-10,"The general skill of using all tension-propelled weapons for archery"),a["Archery.Bow"]=new b("Archery.Bow",-10,"The general skill of using all bow weapons for archery"),a["Archery.Crossbow"]=new b("Archery.Crossbow",-5,"The general skill of using all crossbow weapons for archery"),a.Explosives=new b("Explosives",-20,"The general skill of using all explosives"),a.Melee=new b("Melee",0,"The general skill of using all hand-to-hand weapons, including brass knuckles, legs, fists, heads, etc."),a["Melee.Shield"]=new b("Melee.Shield",-10,"The general skill of using handheld shields as weapons"),a["Melee.Spear"]=new b("Melee.Spear",-15,"The general skill of using spears in hand-to-hand combat"),a["Melee.Knife"]=new b("Melee.Knife",-5,"The general skill of using knives in hand-to-hand combat"),a["Melee.Sword"]=new b("Melee.Sword",-10,"The general skill of using swords in hand-to-hand combat"),a["Melee.Axe"]=new b("Melee.Axe",-15,"The general skill of using axes in hand-to-hand combat"),a["Melee.Hammer"]=new b("Melee.Hammer",-10,"The general skill of using hammers in hand-to-hand combat"),a["Melee.KungFu"]=new b("Melee.KungFu",-35,"The general skill of successfully using techniques in the discipline of kung fu"),a.Throwing=new b("Throwing",0,"The general skill of throwing things"),a["Throwing.Spear"]=new b("Throwing.Spear",-20,"The general skill of throwing spears"),a["Throwing.Knife"]=new b("Throwing.Knife",-10,"The general skill of throwing knives"),a["Throwing.Axe"]=new b("Throwing.Axe",-20,"The general skill of throwing axes"),a.Lockpick=new b("Lockpick",0,"The general skill of using tools to open locks without a key"),a.Mechanics=new b("Mechanics",0,"The general skill of using and repairing machinery or working parts of something"),a["Mechanics.Combustion"]=new b("Mechanics.Combustion",-10,"The general skill of using and repairing machinery and tools that use fuel combustion power"),a["Mechanics.Combustion.Coal"]=new b("Mechanics.Combustion.Coal",-10,"The general skill of using and repairing machinery and tools that use coal for fuel combustion power"),a["Mechanics.Combustion.Hydrocarbon"]=new b("Mechanics.Combustion.Hydrocarbon",-20,"The general skill of using and repairing machinery and tools that use gasoline or diesel for fuel combustion power"),a["Mechanics.Hydraulic"]=new b("Mechanics.Hydraulic",-20,"The general skill of using and repairing machinery and tools that use liquid fluid power to do simple work"),a.Medicine=new b("Medicine",0,"The general skill of help given to a sick or injured person"),a["Medicine.FirstAid"]=new b("Medicine.FirstAid",-5,"The general skill of help given to a sick or injured person until full medical treatment is available"),a.Science=new b("Science",0,"the intellectual and practical activity encompassing the systematic study of the structure and behavior of the physical and natural world through observation and experiment"),a["Science.Botany"]=new b("Science.Botany",-10,"The general skill of working with plants"),a["Science.Mineral"]=new b("Science.Mineral",-15,"The general skill of working with minerals"),a["Science.Electronic"]=new b("Science.Electronic",-20,"The general skill of working with electronic devices"),a["Science.Computer"]=new b("Science.Computer",-10,"The general skill of working with computers"),a["Science.Computer.Programming"]=new b("Science.Computer.Programming",-20,"The general skill of working with computer software"),a["Science.Physics"]=new b("Science.Physics",-10,"The general skill of working with energy and matter using the scientific method"),a["Science.Physics.Optical"]=new b("Science.Physics.Optical",-25,"The general skill of working with light"),a["Science.Physics.Particle"]=new b("Science.Physics.Particle",-35,"The general skill of working with particles"),a["Science.Physics.Astro"]=new b("Science.Physics.Astro",-50,"The general skill of planetary bodies"),a["Science.Rocket"]=new b("Science.Rocket",-50,"The general skill of building rockets"),a.Craftsmanship=new b("Craftsmanship",0,"The general skill of making things"),a["Craftsmanship.Shipbuilding"]=new b("Craftsmanship.Shipbuilding",-20,"The general skill of making boats"),a["Craftsmanship.Leathersmithing"]=new b("Craftsmanship.Leathersmithing",0,"The general skill of making things from leather"),a["Craftsmanship.Gemsmithing"]=new b("Craftsmanship.Gemsmithing",-25,"The general skill of making things from gems"),a["Craftsmanship.Metalsmithing"]=new b("Craftsmanship.Metalsmithing",-10,"The general skill of making things from metals"),a["Craftsmanship.Metalsmithing.Blacksmithing"]=new b("Craftsmanship.Metalsmithing.Blacksmithing",-10,"The general skill of making things from iron and steel"),a["Craftsmanship.Metalsmithing.Goldsmithing"]=new b("Craftsmanship.Metalsmithing.Goldsmithing",-20,"The general skill of making things from gold"),a["Craftsmanship.Metalsmithing.Silversmithing"]=new b("Craftsmanship.Metalsmithing.Silversmithing",-15,"The general skill of making things from silver"),a["Craftsmanship.Furrier"]=new b("Craftsmanship.Furrier",-5,"The general skill of making clothes from animal fur"),a["Craftsmanship.Dyeing"]=new b("Craftsmanship.Dyeing",0,"The general skill of dyeing cloth different colors"),a["Craftsmanship.Gunsmithing"]=new b("Craftsmanship.Gunsmithing",-20,"The general skill of making guns"),a["Craftsmanship.Locksmithing"]=new b("Craftsmanship.Locksmithing",-20,"The general skill of making locks"),a["Craftsmanship.Pottersmithing"]=new b("Craftsmanship.Pottersmithing",-5,"The general skill of making things from clay"),a["Craftsmanship.Stonemasonry"]=new b("Craftsmanship.Stonemasonry",-10,"The general skill of making things from stone"),a["Craftsmanship.Weaving"]=new b("Craftsmanship.Weaving",-5,"The general skill of making things from thread"),a["Craftsmanship.Weaving.Ropesmithing"]=new b("Craftsmanship.Weaving.Ropesmithing",-5,"The general skill of making rope"),a["Craftsmanship.Carpentry"]=new b("Craftsmanship.Carpentry",0,"The general skill of building things with wood"),a["Craftsmanship.Carpentry.Coopersmithing"]=new b("Craftsmanship.Carpentry.Coopersmithing",-5,"The general skill of making barrels"),a.Stealth=new b("Stealth",-10,"The general skill of being undetected"),a["Stealth.Steal"]=new b("Stealth.Steal",-10,"The general skill of taking things undetected"),a["Stealth.Sneak"]=new b("Stealth.Sneak",-5,"The general skill of sneaking around undetected"),a.Survival=new b("Survival",0,"The general skill of surviving on outdoors"),a["Survival.Forest"]=new b("Survival.Forest",-5,"The general skill of surviving in forests"),a["Survival.Desert"]=new b("Survival.Desert",-20,"The general skill of surviving in deserts"),a["Survival.Island"]=new b("Survival.Island",-30,"The general skill of surviving on islands"),a["Survival.Mountain"]=new b("Survival.Mountain",-5,"The general skill of surviving on mountains"),a.Gambling=new b("Gambling",0,"The general skill of gambling"),a["Gambling.Cards"]=new b("Gambling.Cards",-10,"The general skill of gambling with cards"),a["Gambling.Roulette"]=new b("Gambling.Roulette",-20,"The general skill of gambling with a roulette wheel"),a.Speech=new b("Speech",0,"The general skill of moving others with speech"),a["Speech.Persuasion"]=new b("Speech.Persuasion",-10,"The general skill of persuading others"),a["Speech.Barter"]=new b("Speech.Barter",0,"The general skill of negotiating a better price"),a.Piloting=new b("Piloting",0,"The general skill of piloting powered vehicles"),a["Piloting.Boat"]=new b("Piloting.Boat",-10,"The general skill of piloting water vessels"),a["Piloting.Aircraft"]=new b("Piloting.Aircraft",-30,"The general skill of flying aircraft"),a["Piloting.Automobile"]=new b("Piloting.Automobile",-5,"The general skill of driving cars"),a.Athletics=new b("Athletics",0,"The general skill of being physically fit"),a["Athletics.Jump"]=new b("Athletics.Jump",-5,"The general skill of jumping when it counts"),a["Athletics.Climb"]=new b("Athletics.Climb",-10,"The general skill of climbing things"),a["Athletics.Ride"]=new b("Athletics.Ride",-10,"The general skill of riding animals"),a["Athletics.Swim"]=new b("Athletics.Swim",-20,"The general skill of swimming"),a.History=new b("History",0,"The general skill of knowing things"),a}};new Namespace("Specializations",Onto.Skill,a)}(),function(){var a=new Class({inherits:Onto.Base,init:function(a){var b=this;a=a||{};var c={Perception:9,Luck:9},d=Onto._.extend(b.Attributes||c,a.Attributes||c);Class.define(b,"Attributes",Class({}).Enumerable());for(var e in d)Class.define(b.Attributes,e,Class(d[e]).Enumerable());Class.define(b,"Power",{get:function(){return b.Attributes.Perception+b.Attributes.Luck},enumerable:!0})},Power:null});Onto.addClass("Soul",a)}(),function(){var a=new Class({inherits:Onto.Soul,init:function b(a){var c=this;a=a||{};var d={Charisma:9,Intelligence:9};a.Attributes=Onto._.extend(c.Attributes||d,a.Attributes||d),b["super"].call(c,a),Class.define(c,"Chi",{get:function(){return c.Attributes.Luck/2+c.Attributes.Perception+c.Attributes.Intelligence/2},enumerable:!0})},Chi:null});Onto.addClass("Spirit",a)}(),function(){var a=new Class({inherits:Onto.Body,isAbstract:!0,init:function b(a){var c=this;a=a||{};var d={Strength:9,Endurance:9,Agility:9};a.Attributes=Onto._.extend(d,a.Attributes||{}),a.HitLocations=Onto._.extend(this.HitLocations||{},a.HitLocations||{}),a.Inventory=Onto._.extend(this.Inventory||{},a.Inventory||{}),b["super"].call(c,a),Class.define(c,"Attributes",Class({}).Enumerable());var e=new Onto.Spirit(a);for(var f in e.Attributes)Class.define(c.Attributes,f,Class(e.Attributes[f].valueOf()).Enumerable());Class.define(c,"Chi",Class(e.Chi).Enumerable()),Class.define(c,"Power",Class(e.Power).Enumerable()),Class.define(c,"Age",Class(a.Age||18).Writable().Enumerable()),this.Gender=a.Gender||"Male",this.Name=a.Name,Class.define(c,"Size",{get:function(){return(c.Attributes.Strength+c.Attributes.Endurance)/2},enumerable:!0}),Class.define(c,"HitPoints",{get:function(){return 15+c.Attributes.Strength+2*c.Attributes.Endurance},enumerable:!0}),Class.define(c,"MovementSpeed",{get:function(){return Math.max(1+c.Attributes.Agility-c.CurrentDamage,0)},enumerable:!0}),Class.define(c,"AttackSpeed",{get:function(){return Math.max(20-c.Attributes.Agility+c.CurrentDamage,1)},enumerable:!0}),Class.define(c,"MaxCarryWeight",{get:function(){return 12*c.Attributes.Strength},enumerable:!0}),Class.define(c,"Inventory",Class(a.Inventory).Enumerable().Writable())}});Onto.addClass("Being",a)}(),function(){var a=new Class({inherits:Onto.Being,isAbstract:!0,init:function b(a){var c=this;a=a||{},a.Attributes=Onto._.extend(c.Attributes||{},a.Attributes||{}),a.Specializations=a.Specializations||{},a.HitLocations=a.HitLocations||{},a.Inventory=a.Inventory||{},b["super"].call(c,a),Class.define(c,"Skills",Class({}).Enumerable());var d={Firearms:function(){return c.Attributes.Agility+10},Archery:function(){return 2+2*c.Attributes.Agility+c.Attributes.Strength/2},Explosives:function(){return 2+2*c.Attributes.Perception+c.Attributes.Luck/2},Melee:function(){return 30+2*c.Attributes.Agility+2*c.Attributes.Strength},Throwing:function(){return 3*c.Attributes.Agility+c.Attributes.Strength/2},Lockpick:function(){return 20+c.Attributes.Perception/2+c.Attributes.Agility/2},Mechanics:function(){return 20+c.Attributes.Intelligence},Medicine:function(){return c.Attributes.Perception+2*c.Attributes.Intelligence+c.Attributes.Luck/2},Science:function(){return c.Attributes.Perception+2*c.Attributes.Intelligence+c.Attributes.Luck/2},Craftsmanship:function(){return c.Attributes.Intelligence/2+c.Attributes.Luck/2+c.Attributes.Perception/2+c.Attributes.Agility/2},Stealth:function(){return 2+2*c.Attributes.Agility+c.Attributes.Luck/2},Survival:function(){return 2+c.Attributes.Endurance+c.Attributes.Intelligence+c.Attributes.Luck/2},Gambling:function(){return 2+2*c.Attributes.Perception+c.Attributes.Luck/2},Speech:function(){return 2+2*c.Attributes.Charisma+c.Attributes.Luck/2},Athletics:function(){return 2+c.Attributes.Agility+c.Attributes.Strength+c.Attributes.Endurance/2},Piloting:function(){return 2*(c.Attributes.Agility+c.Attributes.Perception)},History:function(){return 2+2*c.Attributes.Intelligence+c.Attributes.Perception/2}};for(var e in d)Class.define(c.Skills,e,{get:d[e],enumerable:!0});var f=Onto.Skill.Specializations.loadDefaults();Class.define(c,"Specializations",Class(f).Enumerable()),c.LoadBodyDefinition({Locations:{Head:{DisplayName:"Head",Health:null,Percentage:5,InventorySlots:{Hat:null,EyeWear:null,EarWear:null,MouthWear:null,NeckWear:null},Wounds:[]},RightArm:{DisplayName:"Right Arm",Health:null,Percentage:10,InventorySlots:{ShoulderWear:null,UpperMidWear:null,ElbowWear:null,LowerMidWear:null,WristWear:null,Gloves:null},Wounds:[]},Chest:{DisplayName:"Chest",Health:null,Percentage:25,InventorySlots:{CollarWear:null,LeftBreastWear:null,RightBreastWear:null,BackWear:null},Wounds:[]},LeftArm:{DisplayName:"Left Arm",Health:null,Percentage:10,InventorySlots:{ShoulderWear:null,UpperMidWear:null,ElbowWear:null,LowerMidWear:null,WristWear:null,Gloves:null},Wounds:[]},Abdomen:{DisplayName:"Abdomen",Health:null,Percentage:20,InventorySlots:{PlexusWear:null,BellyWear:null,Belt:null,GroinWear:null},Wounds:[]},RightLeg:{DisplayName:"Right Leg",Health:null,Percentage:15,InventorySlots:{HipWear:null,UpperMidWear:null,KneeWear:null,LowerMidWear:null,AnkleWear:null,Feet:null},Wounds:[]},LeftLeg:{DisplayName:"Left Leg",Health:null,Percentage:15,InventorySlots:{HipWear:null,UpperMidWear:null,KneeWear:null,LowerMidWear:null,AnkleWear:null,Feet:null},Wounds:[]}}});Class.define(c.HitLocations.Head,"Health",{get:function(){return Math.round(c.HitPoints/5)}}),Class.define(c.HitLocations.RightArm,"Health",{get:function(){return Math.round(c.HitPoints/4)}}),Class.define(c.HitLocations.Chest,"Health",{get:function(){return Math.round(c.HitPoints/2)}}),Class.define(c.HitLocations.LeftArm,"Health",{get:function(){return Math.round(c.HitPoints/4)}}),Class.define(c.HitLocations.Abdomen,"Health",{get:function(){return Math.round(c.HitPoints/3)}}),Class.define(c.HitLocations.RightLeg,"Health",{get:function(){return Math.round(c.HitPoints/3)}}),Class.define(c.HitLocations.LeftLeg,"Health",{get:function(){return Math.round(c.HitPoints/3)}})},Age:0,Gender:"",Name:"",CurrentDamage:null,Damage:null,Size:null,HitPoints:null,MovementSpeed:null,AttackSpeed:null,MaxCarryWeight:null,Skill:function(a){var b=this,c=a.split("."),d=c[0],e=b.Skills[d],f=0;if(f+=e,c.length>1)for(var g=[d],h=1;h<c.length;++h){var i=!1,j=b.Specializations[g.join(".")];if(j?(f+=j.value,g.push(c[h])):i=!0,i)break}return f},Skills:{},Specializations:{}});Onto.addClass("Humanoid",a)}();var CharacterManager=new Class({init:function(){var a=this;this.Characters=function(){for(var a=Storage.getCharacters(),b=0;b<a.length;++b){for(var c=a[b],d=new Character(c.Name,c),e=0;e<d.SaveGames.length;++e){var f=d.SaveGames[e],g=new GameSession(d);g.bind(f),d.SaveGames[e]=g}a[b]=d}return a},this.Character=Character,this.GameSession=GameSession,this.save=function(){for(var a=this.Characters(),b=0;b<a.length;++b)a[b].save()},this.saveCharacters=function(a){Storage.saveCharacters(a)},this.removeCharacter=function(b){var c=[];switch(typeof b){case"number":c=this.Characters(),b<c.length&&a.removeCharacter(c[b].GUID);break;case"string":c=this.Characters();for(var d=0;d<c.length;++d)if(c[d].GUID==b){var e=c[d];if(e){Storage.removeCharacter(e.GUID),c.splice(d,1),Storage.saveCharacters(c);break}}break;case"object":a.removeCharacter(b.GUID)}},this.reset=function(){resetAll()},this.getSaveGame=Storage.getSaveGame}});Onto.addClass("CharacterManager",CharacterManager);var GameSession=function(a){this.Character=a,this.GUID=Utility.GUID(),this.DateCreated=(new Date).getTime(),this.DateModified=null,this.bind=Utility.bind,this.update=function(){this.Character.save(),this.DateModified=(new Date).getTime(),Storage.saveGame(this)},this.saveNew=function(){var a=new GameSession(this.Character);a.bind(JSON.parse(JSON.stringify(this))),a.update()}};return Onto.addClass("GameSession",GameSession),Onto.addNamespace(new Namespace("Races")),function(){var a=new Class({inherits:Onto.Humanoid,init:function b(a){var c=this;a=a||{},a.Attributes=Onto._.extend(c.Attributes||{},a.Attributes||{Strength:9,Perception:9,Endurance:9,Charisma:9,Intelligence:9,Agility:9,Luck:9}),b["super"].call(c,a)}});Onto.Races.addClass("Human",a)}(),function(){var a=new Class({inherits:Onto.Base,init:function b(a){var c=this;a=a||{},b["super"].call(c,a),a=this.parse(a),Onto._.extend(c,a)},toJSON:Class(function c(){var a=c["super"].call(this);return a=Onto._.extend(a,this)})});Onto.addClass("Game",a)}(),Onto});
//# sourceMappingURL=onto.min.js.map